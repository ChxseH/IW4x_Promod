#include maps\mp\gametypes\_hud_util;
main(){if(game["promod_timeout_called"]){thread promod\timeout::main();return;}game["strat_finished"]=0;setDvar("player_sustainammo",1);thread Strat_Time();level waittill("strat_over");foreach(player in level.players){if(player.pers["team"]=="allies"||player.pers["team"]=="axis"&&player.sessionstate=="playing"){player setMoveSpeedScale(1.0-0.05*int(isDefined(player.curClass)&&player.curClass=="assault")*int(isDefined(game["PROMOD_KNIFEROUND"])&&!game["PROMOD_KNIFEROUND"]||!isDefined(game["PROMOD_KNIFEROUND"])));player allowsprint(true);player allowJump(true);player setWeaponAmmoClip("frag_grenade_mp",1);player setWeaponAmmoClip("flash_grenade_mp",1);player setWeaponAmmoClip("smoke_grenade_mp",1);if(!getDvarInt("promod_allow_stratweapon"))player enableWeapons();}}game["strat_finished"]=1;setDvar("player_sustainammo",0);level notify("strat_done");if(game["promod_timeout_called"]){thread promod\timeout::main();return;}}Strat_Time(){thread Strat_Time_Timer();level.strat_over=false;level.strat_time_left=game["PROMOD_STRATTIME"];time_increment=.25;while(!level.strat_over){foreach(player in level.players){if(player.pers["team"]=="allies"||player.pers["team"]=="axis"&&player.sessionstate=="playing"){player setMoveSpeedScale(0);player allowJump(false);player allowsprint(false);player freezeControls(false);player setWeaponAmmoClip("frag_grenade_mp",0);player setWeaponAmmoClip("flash_grenade_mp",0);player setWeaponAmmoClip("smoke_grenade_mp",0);if(!getDvarInt("promod_allow_stratweapon"))player disableWeapons();}}wait time_increment;level.strat_time_left-=time_increment;if(level.strat_time_left<=0||game["promod_timeout_called"]){level notify("kill_strat_timer");level.strat_over=true;}}game["strat_finished"]=1;level notify("strat_over");}Strat_Time_Timer(){matchStartText=createServerFontString("objective",1.5);matchStartText setPoint("CENTER","CENTER",0,-60);matchStartText.sort=1001;if(isDefined(game["PROMOD_KNIFEROUND"])&&game["PROMOD_KNIFEROUND"])matchStartText setText("Knife Round");else matchStartText setText("Strat Time");matchStartText.foreground=false;matchStartText.hidewheninmenu=false;matchStartTimer=createServerTimer("objective",1.4);matchStartTimer setPoint("CENTER","CENTER",0,-45);matchStartTimer setTimer(game["PROMOD_STRATTIME"]);matchStartTimer.sort=1001;matchStartTimer.foreground=false;matchStartTimer.hideWhenInMenu=false;level waittill("kill_strat_timer");if(isDefined(matchStartText))matchStartText destroy();if(isDefined(matchStartTimer))matchStartTimer destroy();}